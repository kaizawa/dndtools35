--alter table MONSTER_SUB_TYPE drop constraint MNSTRSUBTYPEMNSTER;
--alter table MONSTER_SUB_TYPE drop constraint SQL120204101156090;
--alter table MONSTER_MASTER drop constraint SQL120204101156050;
--alter table MONSTER_MASTER drop constraint MNSTERMASTERSIZEID;
--alter table MONSTER_MASTER drop constraint MNSTRMSTERHTDCTYPE;

DROP TABLE SESSION_RECORD;
DROP TABLE MONSTER_FEAT_RECORD;
DROP TABLE MONSTER_SUB_TYPE_RECORD;
DROP TABLE MONSTER_SKILL_RECORD;
DROP TABLE MONSTER_ABILITY_RECORD;
DROP TABLE MONSTER_SAVE_RECORD;
DROP TABLE MONSTER_MASTER;
DROP TABLE FEAT_MASTER;
DROP TABLE TYPE_MASTER;
DROP TABLE SUB_TYPE_MASTER;
-----------


--種別マスター
CREATE TABLE  "TYPE_MASTER"
   (	"ID" INT GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
	"NAME" VARCHAR(100)
   );

--副種別マスター
CREATE TABLE  "SUB_TYPE_MASTER"
   (	"ID" INT GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
	"NAME" VARCHAR(100)
   );


--特技マスター
CREATE TABLE  "FEAT_MASTER"
   (	"ID" INT GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
	"NAME" VARCHAR(100),
        "DESCRIPTION" VARCHAR(4000)
   );

--モンスターマスター
CREATE TABLE "MONSTER_MASTER"
(
  "ID" INT GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
  "NAME" VARCHAR(400),
  "SIZE_ID"  INT,
  "TYPE"  INT, --種別
  "HIT_DICE_TYPE" INT,
  "HIT_DICE_NUM" INT, -- ヒットダイス数 
  "INITIATIVE" INT DEFAULT 0,
  "SPEED" INT,
  "AC" INT,
  "AC_TOUCH" INT,
  "AC_FLAT_FOOTED" INT,
  "BASE_ATTACK" INT,
  "GRAPPLE" INT, 
  "ATTACK" VARCHAR(2000),
  "SPACE_REACH" INT,
  "SPECIAL_ATTACKS" VARCHAR(4000),
  "SPECIAL_QUALITIES" VARCHAR(2000),
  "ENVIRONMENT" VARCHAR(2000),
  "ORGANIZATION" VARCHAR(2000),
  "CHALLENGE_RATING" INT, --脅威度
  "TREASURE" VARCHAR(2000), --宝
  "ALIGNMENT" INT,
  "ADVANCEMENT" VARCHAR(2000), --強大化
  "LEVEL_ADJUSTMENT" INT,

   FOREIGN KEY (ALIGNMENT) REFERENCES ALIGNMENT_MASTER(ID),
   FOREIGN KEY (TYPE) REFERENCES TYPE_MASTER(ID),
   FOREIGN KEY (SIZE_ID) REFERENCES SIZE_MASTER(ID),
   FOREIGN KEY (HIT_DICE_TYPE) REFERENCES DICE_MASTER(ID)
);

--モンスター特技レコード
CREATE TABLE "MONSTER_FEAT_RECORD"
  (     "MONSTER" INT,
        "FEAT" INT,
        "FEAT_MODIFIER" INT DEFAULT 0,
        "DESCRIPTION" VARCHAR(4000),

        PRIMARY KEY (MONSTER, FEAT),
        FOREIGN KEY (MONSTER) REFERENCES MONSTER_MASTER(ID) ON DELETE CASCADE,
        FOREIGN KEY (FEAT) REFERENCES FEAT_MASTER(ID)
   );

--モンスター副種別レコード
CREATE TABLE  "MONSTER_SUB_TYPE_RECORD"
   (    "SUB_TYPE" INT,
        "MONSTER" INT,
        "DESCRIPTION" VARCHAR(400),
        PRIMARY KEY (SUB_TYPE, MONSTER),
        FOREIGN KEY (MONSTER) REFERENCES MONSTER_MASTER(ID) ON DELETE CASCADE,
        FOREIGN KEY (SUB_TYPE) REFERENCES SUB_TYPE_MASTER(ID)
   );

--モンスター技能レコード
CREATE TABLE "MONSTER_SKILL_RECORD"
  (     "MONSTER" INT,
        "SKILL" INT,
        "SKILL_MODIFIER" INT DEFAULT 0,
        "DESCRIPTION" VARCHAR(4000),

        PRIMARY KEY (MONSTER, SKILL),
        FOREIGN KEY (MONSTER) REFERENCES MONSTER_MASTER(ID) ON DELETE CASCADE,
        FOREIGN KEY (SKILL) REFERENCES SKILL_MASTER(ID)
   );

--モンスターセーブレコード
CREATE TABLE "MONSTER_SAVE_RECORD"
  (     "MONSTER" INT,
        "SAVE_ID" INT,
        "MISC_MODIFIER" INT,
        "DESCRIPTION" VARCHAR(400),

        PRIMARY KEY (MONSTER, SAVE_ID),
        FOREIGN KEY (MONSTER) REFERENCES MONSTER_MASTER(ID) ON DELETE CASCADE,
        FOREIGN KEY (SAVE_ID) REFERENCES SAVE_MASTER(ID)
   );

--モンスター能力値レコード
CREATE TABLE "MONSTER_ABILITY_RECORD"
  (     "MONSTER" INT,
        "ABILITY_ID" INT,
        "BASE" INT DEFAULT 0,
        "FEAT_MODIFIER" INT DEFAULT 0,
        "MISC_MODIFIER" INT DEFAULT 0,
        "DESCRIPTION" VARCHAR(400),

        PRIMARY KEY (MONSTER, ABILITY_ID),
        FOREIGN KEY (MONSTER) REFERENCES MONSTER_MASTER(ID) ON DELETE CASCADE,
        FOREIGN KEY (ABILITY_ID) REFERENCES ABILITY_MASTER(ID)
   );

--セッションレコード
CREATE TABLE "SESSION_RECORD"
  (
      "ID" INT,
      "CAMPAIGN" INT, -- キャンペーン
      "TITLE" VARCHAR(400),
      "DESCRIPTION" VARCHAR(8000),

      PRIMARY KEY (ID, CAMPAIGN),
      FOREIGN KEY (CAMPAIGN) REFERENCES CAMPAIGN_MASTER(ID) ON DELETE CASCADE
  ); 
